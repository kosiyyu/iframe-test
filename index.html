<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OneTrust Auto-Blocking Iframe Test</title>

  <script src="https://cdn.cookielaw.org/consent/019b263b-3cfe-737c-800b-ebbf068ade9f/OtAutoBlock.js" type="text/javascript"></script>
  <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="019b263b-3cfe-737c-800b-ebbf068ade9f"></script>

  <script type="text/javascript">
    function OptanonWrapper() { }
  </script>
</head>
<body>
  <h1>OneTrust Auto-Blocking Iframe Test</h1>
  <p>The Floodlight iframe should load only if Marketing cookies (C0004) are accepted.</p>

  <iframe id="floodlight" class="optanon-category-C0004"
    data-src="https://9076148.fls.doubleclick.net/activityi;src=9076148;type=audience;cat=pczb70;ord=3144470219229;npa=0"
    width="0" height="0" style="display:none;"></iframe>

  <script>
    function loadIframeIfConsent() {
      const iframe = document.getElementById("floodlight");

      if (!iframe || !iframe.dataset.src) return;

      // Check if user has consented to Marketing cookies (C0004)
      if (window.OptanonActiveGroups && window.OptanonActiveGroups.includes("C0004")) {
        iframe.src = iframe.dataset.src;
        iframe.style.display = "block";
      }
    }

    window.addEventListener("load", loadIframeIfConsent);

    document.addEventListener("OneTrustGroupsUpdated", loadIframeIfConsent);
  </script>
</body>
</html>
